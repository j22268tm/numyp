# 依頼と解決 (The Quest)

## コンセプト
「今この場所の状況を知りたい」をユーザー同士で即時解決するクエスト機能。依頼主が地図に「調査依頼ピン」を立て、近くにいるウォーカーが報酬コインを受け取りながら最新状況を届ける。

## ロール
- 依頼主 (User A): 知りたい場所に懸賞金つきの調査依頼ピンを立てる。
- ウォーカー (User B): 近くにいるユーザー。通知を受け取り、現地で撮影・報告してコインを獲得。

## 体験フロー
1. 発注: 地図上のカフェをロングタップし、「調査依頼ピン」を作成。タイトル/依頼内容と懸賞金（保有コインから指定）を設定。
2. 通知: ピン半径内にいるウォーカーへ「緊急クエスト発生！」のプッシュ/インアプリ通知を送信。距離と報酬を明示。
3. 現地対応: ウォーカーが「受ける」をタップすると、ナビゲーションで現地へ誘導。到着後に写真撮影とコメント入力。
4. 報告: 「報告」ボタンで写真＋位置＋タイムスタンプを送信。依頼ステータスは「対応中」→「完了」へ更新。
5. 完了/精算: 依頼主は最新写真を受領し、ウォーカーへ懸賞金コインが支払われる。履歴として依頼と報告が残る。

## UIコピー例
- 作成モーダル: 「調査依頼ピン」「今知りたいこと」「懸賞金を設定（コイン）」
- 通知: 「緊急クエスト発生！」「報酬: {coins}コイン」「あなたから{distance}m」
- 対応カード: 「受ける」「向かう」「写真を送る」「報告」
- 完了通知: 「最新の写真が届きました」「コインを支払いました」

## 必要データ (例)
- Quest: id, location, title, description, bountyCoins, status(open/accepted/completed/expired), createdAt, expiresAt
- Participants: requesterId, walkerId?, photoUrl?, comment?, reportedAt
- 通知対象: 位置半径・オンライン状態・クエスト有効期限

## ガード/ルール例
- 懸賞金はウォレット残高以内でロック・支払い。
- 有効期限切れは自動で失効し、コインを返却。
- 近接範囲外からの報告や重複受諾を防ぐための状態管理。
